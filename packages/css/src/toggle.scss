@use '@digdir/ds-tokens/build/tokens.scss' as *;
@use './typography.scss' as *;
@use './baseline/utils.scss' as utils;
@use './baseline/baseline.scss' as baseline;

$classname: '#{utils.$prefix}-toggle';
// Color variables
$toggle-color-checked: $color-interface-interaction;
$toggle-color-unchecked: $color-neutral-grey-300;
$toggle-color-border: $color-neutral-grey-600;
// Size variables
$toggle-size-medium-width: $spacing-base-13;
$toggle-size-medium-height: $spacing-base-7;
$toggle-size-slider: $spacing-base-5;

.#{$classname} {
  box-sizing: border-box;

  min-width: $toggle-size-medium-width;

  & input.#{$classname}__input {
    cursor: pointer;
    // Hide browser-default checkmark appearance
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    &:focus {
      outline: none;
    }
  }

  &__label {
    display: flex;
    align-items: center;
    position: relative;
    overflow-wrap: break-word;
    padding-left: $toggle-size-medium-width + $spacing-base-2;

    cursor: pointer;
    @include text-body-400();
    color: $toggle-color-border;

    transition: color $duration-normal;
  }

  // Toggle button container
  & .#{$classname}__label::before {
    content: '';
    display: inline-block;
    box-sizing: border-box;
    position: absolute;
    left: 0;

    width: $toggle-size-medium-width;
    height: $toggle-size-medium-height;

    background-color: $toggle-color-unchecked;
    border: $border-width-default solid $toggle-color-border;
    border-radius: $border-radius-medium;

    transition: $duration-normal;
    transition-property: background-color, border-color;
  }

  // Toggle button slider
  & .#{$classname}__label::after {
    content: '';
    display: inline-block;
    box-sizing: border-box;
    position: absolute;
    left: $spacing-base-1;

    width: $toggle-size-slider;
    height: $toggle-size-slider;
    border-radius: 50%;

    background-color: $color-neutral-white;
    border: $border-width-default solid $toggle-color-border;

    transition: $duration-normal;
    transition-property: left, border-color;
  }

  // Checked states
  & input.#{$classname}__input:checked {
    & ~ .#{$classname}__label {
      color: $color-text-background-light;
    }
    // Checked toggle button container
    & ~ .#{$classname}__label::before {
      background-color: $toggle-color-checked;
      border-color: $toggle-color-checked;
    }
    // Checked toggle button slider
    & ~ .#{$classname}__label::after {
      border-color: $color-neutral-white;
      left: $spacing-base-7;
    }
  }

  // Focus outline
  & input.#{$classname}__input {
    &:focus-visible ~ .#{$classname}__label {
      @include baseline.focus-outline();
    }
    // Compatibility for browsers not supporting :focus-visible (Safari, IE)
    &:focus ~ .#{$classname}__label {
      @include baseline.focus-outline();
    }
    &:focus:not(:focus-visible) ~ .#{$classname}__label {
      outline: none;
    }
  }
}
