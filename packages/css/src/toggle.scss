@use '@digdir/ds-tokens/build/tokens.scss' as *;
@use './typography.scss' as *;
@use './baseline/utils.scss' as utils;
@use './baseline/baseline.scss' as baseline;

$classname: '#{utils.$prefix}-toggle';
// Color variables
$toggle-color-checked: $color-interface-interaction;
$toggle-color-unchecked: $color-neutral-grey-300;
$toggle-color-border: $color-neutral-grey-600;
// Size variables
$toggle-size-small-width: $spacing-base-11;
$toggle-size-small-height: $spacing-base-6;
$toggle-size-medium-width: $spacing-base-13;
$toggle-size-medium-height: $spacing-base-7;
$toggle-size-slider-small: $spacing-base-4;
$toggle-size-slider-medium: $spacing-base-5;
$toggle-padding-label: $spacing-base-2;

.#{$classname} {
  display: flex;
  flex-direction: row;
  box-sizing: border-box;

  & input.#{$classname}__input {
    cursor: pointer;
    // Hide browser-default checkmark appearance
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;

    // Focus outline
    &:focus {
      outline: none;
    }
    &:focus-visible ~ .#{$classname}__label {
      @include baseline.focus-outline();
    }
    // Compatibility for browsers not supporting :focus-visible (Safari, IE)
    &:focus ~ .#{$classname}__label {
      @include baseline.focus-outline();
    }
    &:focus:not(:focus-visible) ~ .#{$classname}__label {
      outline: none;
    }
  }
  &__label,
  &__decoupled-label-left,
  &__decoupled-label-right {
    overflow-wrap: anywhere;
    @include text-body-400();
    color: $color-text-background-light;
    transition: color $duration-normal;
  }
  &__label {
    display: flex;
    align-items: center;
    position: relative;
    padding-left: $toggle-size-medium-width;

    cursor: pointer;
    &--right {
      padding-left: $toggle-size-medium-width + $toggle-padding-label;
    }
    &--left {
      padding-left: 0;
      padding-right: $toggle-size-medium-width + $toggle-padding-label;
    }

    &--toggle-on {
      color: $toggle-color-border;
    }
    &--toggle-off {
      color: $color-text-background-light;
    }
  }
  &__decoupled-label-left {
    padding-right: $toggle-padding-label;
  }
  &__decoupled-label-right {
    padding-left: $toggle-padding-label;
  }

  // Toggle button container
  & .#{$classname}__label {
    &::before {
      content: '';
      display: inline-block;
      box-sizing: border-box;
      position: absolute;
      left: 0;

      width: $toggle-size-medium-width;
      height: $toggle-size-medium-height;

      background-color: $toggle-color-unchecked;
      border: $border-width-default solid $toggle-color-border;
      border-radius: $border-radius-medium;

      transition: $duration-normal;
      transition-property: background-color, border-color;
    }
    &--left::before {
      left: auto;
      right: 0;
    }
  }

  // Toggle button slider
  & .#{$classname}__label {
    &::after {
      content: '';
      display: inline-block;
      box-sizing: border-box;
      position: absolute;
      left: $spacing-base-1;

      width: $toggle-size-slider-medium;
      height: $toggle-size-slider-medium;
      border-radius: 50%;

      background-color: $color-neutral-white;
      border: $border-width-default solid $toggle-color-border;

      transition: $duration-normal;
      transition-property: left, right, border-color;
    }
    &--left::after {
      left: auto;
      right: $spacing-base-7;
    }
  }

  &--small & {
    &__label,
    &__decoupled-label-left,
    &__decoupled-label-right {
      @include text-body-300();
    }

    &__label {
      &--right {
        padding-left: $toggle-size-small-width + $toggle-padding-label;
      }
      &--left {
        padding-right: $toggle-size-small-width + $toggle-padding-label;
      }
    }

    &__label::before {
      width: $toggle-size-small-width;
      height: $toggle-size-small-height;
    }
    &__label::after {
      width: $toggle-size-slider-small;
      height: $toggle-size-slider-small;
    }
    &__label--left::after {
      right: $spacing-base-6;
    }
  }

  // Checked states
  & input.#{$classname}__input:checked {
    & ~ .#{$classname}__label--toggle-on {
      color: $color-text-background-light;
    }
    & ~ .#{$classname}__label--toggle-off {
      color: $toggle-color-border;
    }
    // Checked toggle button container
    & ~ .#{$classname}__label::before {
      background-color: $toggle-color-checked;
      border-color: $toggle-color-checked;
    }
    // Checked toggle button slider
    & ~ .#{$classname}__label::after {
      border-color: $color-neutral-white;
    }
  }
  // Checked toggle button slider reposition
  & input.#{$classname}__input:checked {
    & ~ .#{$classname}__label:not(.#{$classname}__label--left)::after {
      left: $spacing-base-7;
    }
    & ~ .#{$classname}__label--left::after {
      right: $spacing-base-1;
    }
  }
  &.#{$classname}--small input.#{$classname}__input:checked {
    & ~ .#{$classname}__label::after {
      left: $spacing-base-6;
    }
  }
}
