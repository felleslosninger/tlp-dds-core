@use '@digdir/ds-tokens/build/tokens.scss' as *;
@use './typography.scss' as *;
@use './baseline/utils.scss' as utils;
@use './baseline/baseline.scss' as baseline;

$classname: '#{utils.$prefix}-radio';
// Color variables
$radio-color-unchecked: $color-neutral-grey-600;
$radio-color-checked: $color-interface-interaction;
$radio-color-disabled: $color-neutral-grey-500;
// Size variables
$radio-size-medium: $spacing-base-6;
$radio-size-large: $spacing-base-8;
$radio-size-checkmark-medium: $spacing-base-3;
$radio-size-checkmark-large: calc($radio-size-checkmark-medium * 1.5);
$radio-padding-label-medium: $spacing-base-2;
$radio-padding-label-large: $spacing-base-4;

.#{$classname} {
  display: inline-flex;
  align-items: center;
  box-sizing: border-box;
  cursor: pointer;

  & input.#{$classname}__input {
    cursor: pointer;
    // Hide browser-default radio appearance
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    margin: 0;

    // Focus outline
    &:focus {
      outline: none;
    }
    &:focus-visible ~ .#{$classname}__label {
      @include baseline.focus-outline();
    }
    // Compatibility for browsers not supporting :focus-visible (Safari, IE)
    &:focus ~ .#{$classname}__label {
      @include baseline.focus-outline();
    }
    &:focus:not(:focus-visible) ~ .#{$classname}__label {
      outline: none;
    }
  }

  &__label {
    display: flex;
    align-items: center;
    position: relative;

    padding-left: $radio-size-medium;
    min-height: $radio-size-medium;

    cursor: pointer;
    @include text-body-300();
    color: $color-text-background-light;

    &--right {
      padding-left: calc($radio-size-medium + $radio-padding-label-medium);
    }

    // Radio button container
    &::before {
      content: '';
      display: inline-block;
      box-sizing: border-box;
      position: absolute;
      left: 0;

      // Medium size
      width: $radio-size-medium;
      height: $radio-size-medium;

      // Custom radio appearance
      border-radius: 50%;
      background-color: $color-neutral-white;

      border: $border-width-default solid $radio-color-unchecked;

      transition: border-color $duration-fast;
    }

    // Radio button checkmark
    &::after {
      content: '';
      display: inline-block;
      box-sizing: border-box;
      position: absolute;
      left: calc(($radio-size-medium - $radio-size-checkmark-medium) / 2);

      // Medium size
      width: $radio-size-checkmark-medium;
      height: $radio-size-checkmark-medium;

      border-radius: 50%;
      background-color: $color-neutral-white;

      transition: background-color $duration-fast;
    }
  }

  // Hover and checked states
  &:not([class*='#{$classname}--disabled']) > input.#{$classname}__input {
    &:hover:not(:checked) ~ .#{$classname}__label {
      &::before {
        border-color: $radio-color-checked;
      }
      &::after {
        background-color: $color-interface-interaction-light;
      }
    }
    &:checked ~ .#{$classname}__label {
      &::before {
        border-color: $radio-color-checked;
      }
      &::after {
        background-color: $radio-color-checked;
      }
    }
  }

  &--disabled {
    &:active {
      pointer-events: none;
    }

    & > .#{$classname}__label {
      cursor: not-allowed;
      color: $radio-color-disabled;
      &::before {
        border-color: $radio-color-disabled;
      }
    }
    & > input.#{$classname}__input:checked ~ .#{$classname}__label::after {
      background-color: $radio-color-disabled;
    }
  }

  // Size modifiers
  &--large {
    & > .#{$classname}__label {
      min-height: $radio-size-large;
      padding-left: calc($radio-size-large + $radio-padding-label-large);
      @include text-body-400();

      &::before {
        width: $radio-size-large;
        height: $radio-size-large;
      }

      &::after {
        left: calc(($radio-size-large - $radio-size-checkmark-large) / 2);
        width: $radio-size-checkmark-large;
        height: $radio-size-checkmark-large;
      }
    }
  }
}
